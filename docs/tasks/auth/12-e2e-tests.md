# 12 — E2E и интеграционные тесты

Цель
- Проверить сквозной сценарий входа и основные ветки ошибок.

Сценарии
- Happy‑path: фронт создаёт `sid` → пользователь жмёт Start → webhook подтверждает → фронт получает `AuthResponse` → защищённый запрос проходит.
- С инвайтом: `sid` связан с инвайтом → после подтверждения членство создано, активная семья — по инвайту.
- Повторные апдейты: webhook доставлен дважды → состояние стабильное.
- Истечение: `sid` истёк до подтверждения → опрос возвращает 410.
- Refresh: по `refresh` выдается новый access, старый `jti` в блок‑лист.
- Logout: после выхода доступ с прежним `access` запрещён.

Технически
- Поднять Redis (тестовый контейнер) для интеграционных тестов.
- Моки Telegram webhook (HTTP) с секретом.

Критерии
- Все сценарии завершаются с ожидаемыми статусами/ответами.

